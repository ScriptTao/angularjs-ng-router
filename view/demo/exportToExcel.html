<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>导出excel</title>

    <link rel="stylesheet" href="../../bootstrap-3.3.7/css/bootstrap.min.css">
    <link rel="stylesheet" href="../../DataTables/DataTables-1.10.16/css/jquery.dataTables.css">
    <link rel="stylesheet" href="../../highlight/styles/rainbow.css">
    <link rel="stylesheet" href="../../css/ustb.css">
</head>
<body>
<div class="container">
    <div class="page-header">
        <h1>导出excel功能演示</h1>
    </div>

    <h3>基本使用方法</h3>
    <p>在html文档body底部引入javascript文件。请注意引入的文件路径</p>
    <pre><code class="html">
&lt;script src="../../jquery-3.2.1/jquery-3.2.1.min.js"&gt;&lt;/script&gt;
&lt;script src="../../bootstrap-3.3.7/js/bootstrap.min.js"&gt;&lt;/script&gt;
&lt;script src="../../DataTables/datatables.js"&gt;&lt;/script&gt;
&lt;script src="../../echarts/echarts-3.8.0.js"&gt;&lt;/script&gt;
&lt;script src="../../js/q.js""&gt;&lt;/script"&gt;
&lt;script src="../../js/ustb.js"&gt;&lt;/script&gt;
    </code></pre>

    <p>导出excel表格</p>
    <pre><code>
    var template = "";
    var tags = [
        {
            "name": "tag1",
            "value": "tag2"
        },
        {
            "name": "tag2",
            "dataList": [
                {
                    "col1": "1 - 1",
                    "col2": "1 - 2"
                },
                {
                    "col1": "2 - 1",
                    "col2": "2 - 2"
                }
            ]
        }
    ];
    ustb.exportToExcel(template, tags);
    </code></pre>

    <button id="btnCall" class="btn btn-primary">执行</button>

    <p>
        导出函数支持导出多个tag，tag如果是数值类型，则设置其value属性。如果是数据集类型，则设置其dataList属性。
        除了直接写json对象外，也可以使用json语法动态生成json对象。
    </p>

    <div style="height:300px;"></div>
</div>
</body>

<script src="../../jquery-3.2.1/jquery-3.2.1.min.js"></script>
<script src="../../bootstrap-3.3.7/js/bootstrap.min.js"></script>
<script src="../../highlight/highlight.pack.js"></script>
<script src="../../echarts/echarts-3.8.0.js"></script>
<script src="../../js/q.js"></script>
<script src="../../js/ustb.js"></script>

<script language="JavaScript">
    hljs.initHighlightingOnLoad();

    $(document).ready(function () {
        $("#btnCall").click(function () {
            var template = "";
            var tags = [
                {
                    "name": "single",
                    "value": "single tag value"
                },
                {
                    "name": "tag2",
                    "dataList": [
                    ]
                }
            ];

            for (var i=0; i<10000; i++) {
                var data = {};
                for (var j=0; j<100; j++) {
                    data["col" + j] = i + " - " + j;
                }
                tags[1].dataList.push(data);
            }
            ustb.exportToExcel(template, tags);
        });
    });

</script>
</html>